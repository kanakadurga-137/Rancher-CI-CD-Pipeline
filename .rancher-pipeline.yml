stages:
- name: Get Latest Commit ID
  steps:
  - runScriptConfig:
      image: node:latest
      shellScript: LCOMMIT_ID=$(git rev-parse --verify HEAD)
    env:
      COMMIT_ID: ${LCOMMIT_ID}
- name: Build and Push Images
  steps:
  - runScriptConfig:
      image: node:latest
      shellScript: |-
        sudo docker build -t mbhaskar2005/firstdockerrepo:${COMMIT_ID}

        sudo docker login -u mbhaskar2005 -p ${docker-pwd}

        sudo docker push mbhaskar2005/firstdockerrepo:${COMMIT_ID}
    envFrom:
    - sourceName: s-hzvht
      sourceKey: passwd
      targetKey: docker-pwd
timeout: 60
branch:
  include:
  - master
notification: {}
